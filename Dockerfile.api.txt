# Usando imagem Node.js completa (Debian) para garantir que drivers nativos do SQL Server (msnodesqlv8/tedious) compilem corretamente
FROM node:20

# Diretório de trabalho no container
WORKDIR /app

# Inicializa um projeto node vazio para instalar dependências
RUN npm init -y

# Instala as dependências do Backend diretamente
# Inclui express, mssql (driver SQL), cors e a biblioteca de IA
RUN npm install express mssql cors @google/genai --save

# Copia o código do servidor
COPY api_server.js .

# Expõe a porta da API
EXPOSE 8080

# Comando de inicialização
CMD ["node", "api_server.js"]